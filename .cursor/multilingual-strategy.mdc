---
alwaysApply: true
---

# ë‹¤êµ­ì–´ ì½˜í…ì¸  ê´€ë¦¬ ì „ëµ

## ğŸ“‹ ê°œìš”

ë£¨ë¯¸ë¥´ CMSì—ì„œ ë¸Œë¡œìŠˆì–´, ì „ìê³µì‹œ ë“± ëª¨ë“  ë‹¤êµ­ì–´ ì½˜í…ì¸ ëŠ” **ë™ì¼í•œ ë‹¤êµ­ì–´ ì „ëµ**ì„ ë”°ë¦…ë‹ˆë‹¤.

## ğŸŒ ê¸°ë³¸ ì–¸ì–´ ì„¤ì •

ì‹œìŠ¤í…œì˜ **ê¸°ë³¸ ì–¸ì–´**ëŠ” í™˜ê²½ ë³€ìˆ˜ `DEFAULT_LANGUAGE_CODE`ë¥¼ í†µí•´ ì„¤ì •ë©ë‹ˆë‹¤:

```env
# .env íŒŒì¼
DEFAULT_LANGUAGE_CODE=en  # ko, en, ja, zh ì¤‘ ì„ íƒ (ê¸°ë³¸ê°’: en)
```

ì´ ì„¤ì •ì€ ë‹¤ìŒì— ì˜í–¥ì„ ë¯¸ì¹©ë‹ˆë‹¤:
- **ë²ˆì—­ ë™ê¸°í™” ê¸°ì¤€ ì–¸ì–´** - `isSynced=true`ì¸ ë²ˆì—­ë“¤ì´ ê¸°ë³¸ ì–¸ì–´ë¥¼ ë”°ë¼ê°
- **ëª©ë¡ ì¡°íšŒ ì‹œ ê¸°ë³¸ í‘œì‹œ ì–¸ì–´** - API ì‘ë‹µì—ì„œ ìš°ì„ ì ìœ¼ë¡œ í‘œì‹œë˜ëŠ” ì–¸ì–´
- **ì½˜í…ì¸  ìƒì„± ì‹œ ê¸°ì¤€ ì–¸ì–´** - ë‹¤ë¥¸ ì–¸ì–´ ë²ˆì—­ ìë™ ìƒì„±ì˜ ê¸°ì¤€
- **ì‹œë“œ ë°ì´í„° ìƒì„±** - ì´ˆê¸° ë°ì´í„°ì˜ ì–¸ì–´

> ğŸ“– ìì„¸í•œ ë‚´ìš©ì€ [ê¸°ë³¸ ì–¸ì–´ ì„¤ì • ê°€ì´ë“œ](../docs/DEFAULT_LANGUAGE_CONFIGURATION.md)ë¥¼ ì°¸ê³ í•˜ì„¸ìš”.

## ğŸŒ í•µì‹¬ ì „ëµ

### 1. ìë™ ë‹¤êµ­ì–´ ì§€ì›

ì½˜í…ì¸ ë¥¼ ìƒì„±í•  ë•Œ, **ì „ë‹¬ë°›ì€ ì–¸ì–´**ì™€ **ì‹œìŠ¤í…œì— ë“±ë¡ëœ ëª¨ë“  í™œì„± ì–¸ì–´**ì— ëŒ€í•´ ìë™ìœ¼ë¡œ ë²ˆì—­ ë ˆì½”ë“œë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

```
ì˜ˆì‹œ: ê¸°ë³¸ ì–¸ì–´(ì˜ˆ: ì˜ì–´)ë¡œ ë¸Œë¡œìŠˆì–´ ìƒì„± ì‹œ
- ì˜ì–´: ì‚¬ìš©ìê°€ ì…ë ¥í•œ ì œëª©/ì„¤ëª… (isSynced: false)
- í•œêµ­ì–´: ì˜ì–´ ì œëª©/ì„¤ëª… ë³µì‚¬ (isSynced: true)
- ì¼ë³¸ì–´: ì˜ì–´ ì œëª©/ì„¤ëª… ë³µì‚¬ (isSynced: true)
- ì¤‘êµ­ì–´: ì˜ì–´ ì œëª©/ì„¤ëª… ë³µì‚¬ (isSynced: true)
```

### 2. ë²ˆì—­ ë™ê¸°í™” í”Œë˜ê·¸ (isSynced)

ê° ë²ˆì—­ ë ˆì½”ë“œëŠ” `isSynced` í”Œë˜ê·¸ë¥¼ ê°€ì§‘ë‹ˆë‹¤:

| isSynced | ì˜ë¯¸                           | ì‚¬ìš© ì‹œì                   |
| -------- | ------------------------------ | -------------------------- |
| `false`  | ê°œë³„ ì„¤ì •ëœ ë²ˆì—­ (ìˆ˜ë™)        | ì‚¬ìš©ìê°€ ì§ì ‘ ì…ë ¥í•œ ë²ˆì—­  |
| `true`   | ìë™ ë™ê¸°í™”ëœ ë²ˆì—­ (ê¸°ì¤€ ë³µì‚¬) | ì‹œìŠ¤í…œì´ ìë™ ìƒì„±í•œ ë²ˆì—­  |

### 3. ê¸°ì¤€ ì–¸ì–´ ì„ ì •

ìë™ ë™ê¸°í™” ì‹œ ê¸°ì¤€ì´ ë˜ëŠ” ë²ˆì—­ì€ ë‹¤ìŒ ìš°ì„ ìˆœìœ„ë¡œ ê²°ì •ë©ë‹ˆë‹¤:

1. **ê¸°ë³¸ ì–¸ì–´** - `DEFAULT_LANGUAGE_CODE` í™˜ê²½ ë³€ìˆ˜ì— ì„¤ì •ëœ ì–¸ì–´ (ê¸°ë³¸ê°’: en)
2. **ì²« ë²ˆì§¸ ë²ˆì—­** - ê¸°ë³¸ ì–¸ì–´ê°€ ì—†ìœ¼ë©´ ì‚¬ìš©ìê°€ ì…ë ¥í•œ ì²« ë²ˆì§¸ ë²ˆì—­

## ğŸ”„ ìƒì„± í”„ë¡œì„¸ìŠ¤

### ë‹¨ê³„ë³„ íë¦„

```mermaid
flowchart TD
    Start([ì½˜í…ì¸  ìƒì„± ìš”ì²­])
    Start --> ValidateLang[ì–¸ì–´ ID ê²€ì¦]
    ValidateLang --> CheckDup{ì¤‘ë³µ ì–¸ì–´<br/>ì²´í¬}
    CheckDup -->|ì¤‘ë³µ ìˆìŒ| Error1[400 ì—ëŸ¬]
    CheckDup -->|ì¤‘ë³µ ì—†ìŒ| GetAllLang[ëª¨ë“  í™œì„± ì–¸ì–´<br/>ì¡°íšŒ]
    
    GetAllLang --> CreateContent[ë©”ì¸ ì½˜í…ì¸  ìƒì„±]
    CreateContent --> CreateCustom[ì‚¬ìš©ì ì…ë ¥ ë²ˆì—­ ìƒì„±<br/>isSynced: false]
    
    CreateCustom --> FindBase[ê¸°ì¤€ ë²ˆì—­ ì°¾ê¸°<br/>ê¸°ë³¸ì–¸ì–´ or ì²«ë²ˆì§¸]
    FindBase --> CheckRemain{ì „ë‹¬ë˜ì§€ ì•Šì€<br/>ì–¸ì–´ ìˆë‚˜?}
    
    CheckRemain -->|ìˆìŒ| CreateSynced[ìë™ ë™ê¸°í™” ë²ˆì—­ ìƒì„±<br/>isSynced: true]
    CheckRemain -->|ì—†ìŒ| Complete
    CreateSynced --> Complete([ìƒì„± ì™„ë£Œ])
    
    style CreateCustom fill:#e1f5e1
    style CreateSynced fill:#fff4e1
    style Error1 fill:#ffe1e1
```

### ì½”ë“œ ì˜ˆì‹œ (ë¸Œë¡œìŠˆì–´)

```typescript
// 1. ì „ë‹¬ë°›ì€ ì–¸ì–´ë“¤ì— ëŒ€í•œ ë²ˆì—­ ìƒì„± (isSynced: false)
const customTranslations = data.translations.map((trans) =>
  this.translationRepository.create({
    brochureId: saved.id,
    languageId: trans.languageId,
    title: trans.title,
    description: trans.description || null,
    isSynced: false, // ê°œë³„ ì„¤ì •
    createdBy: data.createdBy,
  }),
);
await this.translationRepository.save(customTranslations);

// 2. ê¸°ì¤€ ë²ˆì—­ ì„ ì •
const defaultLanguageCode = this.configService.get<string>('DEFAULT_LANGUAGE_CODE', 'en');
const defaultLang = languages.find((l) => l.code === defaultLanguageCode);
const baseTranslation =
  data.translations.find((t) => t.languageId === koreanLang?.id) ||
  data.translations[0];

// 3. ë‚˜ë¨¸ì§€ ì–¸ì–´ë“¤ì— ëŒ€í•œ ë²ˆì—­ ìƒì„± (isSynced: true)
const remainingLanguages = allLanguages.filter(
  (lang) => !languageIds.includes(lang.id),
);

if (remainingLanguages.length > 0) {
  const syncedTranslations = remainingLanguages.map((lang) =>
    this.translationRepository.create({
      brochureId: saved.id,
      languageId: lang.id,
      title: baseTranslation.title,
      description: baseTranslation.description || null,
      isSynced: true, // ìë™ ë™ê¸°í™”
      createdBy: data.createdBy,
    }),
  );
  await this.translationRepository.save(syncedTranslations);
}
```

## ğŸ“ ìˆ˜ì • í”„ë¡œì„¸ìŠ¤

### ë²ˆì—­ ìˆ˜ì • ì‹œë‚˜ë¦¬ì˜¤

#### ì‹œë‚˜ë¦¬ì˜¤ 1: ê°œë³„ ë²ˆì—­ ìˆ˜ì • (isSynced: false â†’ false)

```
ìƒí™©: ì˜ì–´ ë²ˆì—­ì„ ìˆ˜ì •
ê²°ê³¼: í•´ë‹¹ ì˜ì–´ ë²ˆì—­ë§Œ ì—…ë°ì´íŠ¸, isSyncedëŠ” false ìœ ì§€
```

#### ì‹œë‚˜ë¦¬ì˜¤ 2: ë™ê¸°í™”ëœ ë²ˆì—­ ìˆ˜ì • (isSynced: true â†’ false)

```
ìƒí™©: ìë™ ìƒì„±ëœ ì¼ë³¸ì–´ ë²ˆì—­ì„ ìˆ˜ì •
ê²°ê³¼: 
- ì¼ë³¸ì–´ ë²ˆì—­ ì—…ë°ì´íŠ¸
- isSyncedë¥¼ falseë¡œ ë³€ê²½ (ì´ì œ ê°œë³„ ê´€ë¦¬ë¨)
```

#### ì‹œë‚˜ë¦¬ì˜¤ 3: ê¸°ì¤€ ë²ˆì—­ ìˆ˜ì • + ìë™ ë™ê¸°í™”

```
ìƒí™©: ê¸°ë³¸ ì–¸ì–´(ê¸°ì¤€) ë²ˆì—­ ìˆ˜ì •
ì„ íƒ 1: ë™ê¸°í™”ëœ ë²ˆì—­ ì¼ê´„ ì—…ë°ì´íŠ¸ (isSynced: trueì¸ ê²ƒë“¤)
ì„ íƒ 2: í•´ë‹¹ ë²ˆì—­ë§Œ ìˆ˜ì • (ìë™ ë™ê¸°í™” ë¹„í™œì„±í™”)
```

## ğŸ¯ ì£¼ìš” ê²€ì¦ ê·œì¹™

### 1. ì–¸ì–´ ID ê²€ì¦

- ëª¨ë“  ë²ˆì—­ì˜ `languageId`ê°€ ìœ íš¨í•œì§€ í™•ì¸
- ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì–¸ì–´ IDë©´ 400 ì—ëŸ¬

### 2. ì¤‘ë³µ ì–¸ì–´ ì²´í¬

- í•˜ë‚˜ì˜ ì½˜í…ì¸ ì— ê°™ì€ ì–¸ì–´ê°€ ì¤‘ë³µë˜ë©´ ì•ˆ ë¨
- ì¤‘ë³µ ë°œê²¬ ì‹œ 400 ì—ëŸ¬

```typescript
// ì¤‘ë³µ ì²´í¬ ë¡œì§
const languageIds = data.translations.map((t) => t.languageId);
const uniqueLanguageIds = new Set(languageIds);
if (uniqueLanguageIds.size !== languageIds.length) {
  throw new BadRequestException('ì¤‘ë³µëœ ì–¸ì–´ IDê°€ ìˆìŠµë‹ˆë‹¤.');
}
```

### 3. ìµœì†Œ ë²ˆì—­ ê°œìˆ˜

- ìµœì†Œ 1ê°œ ì´ìƒì˜ ë²ˆì—­ í•„ìš”
- ë²ˆì—­ì´ ì—†ìœ¼ë©´ 400 ì—ëŸ¬

## ğŸ”§ êµ¬í˜„ ì²´í¬ë¦¬ìŠ¤íŠ¸

### í•„ìˆ˜ êµ¬í˜„ í•­ëª©

- âœ… **ì—”í‹°í‹° êµ¬ì¡°**
  - [ ] ë©”ì¸ ì—”í‹°í‹° (Brochure, ElectronicDisclosure ë“±)
  - [ ] ë²ˆì—­ ì—”í‹°í‹° (BrochureTranslation, ElectronicDisclosureTranslation ë“±)
  - [ ] `isSynced` boolean í•„ë“œ

- âœ… **ìƒì„± ë¡œì§**
  - [ ] ì–¸ì–´ ID ê²€ì¦
  - [ ] ì¤‘ë³µ ì–¸ì–´ ì²´í¬
  - [ ] ëª¨ë“  í™œì„± ì–¸ì–´ ì¡°íšŒ
  - [ ] ì‚¬ìš©ì ì…ë ¥ ë²ˆì—­ ìƒì„± (isSynced: false)
  - [ ] ê¸°ì¤€ ë²ˆì—­ ì„ ì • (ê¸°ë³¸ ì–¸ì–´ ìš°ì„ )
  - [ ] ë‚˜ë¨¸ì§€ ì–¸ì–´ ìë™ ë²ˆì—­ ìƒì„± (isSynced: true)

- âœ… **ìˆ˜ì • ë¡œì§**
  - [ ] ê°œë³„ ë²ˆì—­ ìˆ˜ì •
  - [ ] isSynced í”Œë˜ê·¸ ê´€ë¦¬
  - [ ] (ì„ íƒ) ìë™ ë™ê¸°í™” ì—…ë°ì´íŠ¸

- âœ… **ì¡°íšŒ ë¡œì§**
  - [ ] ë²ˆì—­ í¬í•¨ ì¡°íšŒ (relations: ['translations'])
  - [ ] ì–¸ì–´ë³„ í•„í„°ë§ ì§€ì›

## ğŸ“Š ë°ì´í„° êµ¬ì¡°

### ë©”ì¸ ì—”í‹°í‹° (ê³µí†µ)

```typescript
{
  id: uuid,
  isPublic: boolean,
  status: ContentStatus,
  order: number,
  attachments: jsonb | null,
  createdAt: timestamp,
  updatedAt: timestamp,
  deletedAt: timestamp | null,
  createdBy: uuid | null,
  updatedBy: uuid | null,
  version: number
}
```

### ë²ˆì—­ ì—”í‹°í‹° (ê³µí†µ)

```typescript
{
  id: uuid,
  [contentName]Id: uuid,  // brochureId, electronicDisclosureId ë“±
  languageId: uuid,
  title: varchar(500),
  description: text | null,
  isSynced: boolean,  // ğŸ”‘ í•µì‹¬ í”Œë˜ê·¸
  createdAt: timestamp,
  updatedAt: timestamp,
  deletedAt: timestamp | null,
  createdBy: uuid | null,
  updatedBy: uuid | null,
  version: number
}
```

## ğŸŒ ì§€ì› ì–¸ì–´ ëª©ë¡

ì‹œìŠ¤í…œì— ë“±ë¡ëœ ëª¨ë“  í™œì„± ì–¸ì–´ì— ëŒ€í•´ ìë™ìœ¼ë¡œ ë²ˆì—­ì´ ìƒì„±ë©ë‹ˆë‹¤.

ê¸°ë³¸ ì–¸ì–´:
- ğŸŒ ê¸°ë³¸ ì–¸ì–´ - `DEFAULT_LANGUAGE_CODE` í™˜ê²½ ë³€ìˆ˜ë¡œ ì„¤ì • (ê¸°ë³¸ê°’: en)
- ğŸ‡ºğŸ‡¸ ì˜ì–´ (en)
- ğŸ‡¯ğŸ‡µ ì¼ë³¸ì–´ (ja)
- ğŸ‡¨ğŸ‡³ ì¤‘êµ­ì–´ (zh)

ì¶”ê°€ ì–¸ì–´ëŠ” ê´€ë¦¬ìê°€ `/api/admin/languages`ë¥¼ í†µí•´ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ğŸ’¡ ì¥ì 

### 1. ì™„ì „í•œ ë‹¤êµ­ì–´ ì§€ì›
- ìƒˆë¡œìš´ ì–¸ì–´ê°€ ì¶”ê°€ë˜ì–´ë„ ê¸°ì¡´ ì½˜í…ì¸ ê°€ ìë™ìœ¼ë¡œ í•´ë‹¹ ì–¸ì–´ë¥¼ ì§€ì›
- ì‚¬ìš©ìëŠ” ì›í•˜ëŠ” ì–¸ì–´ë§Œ ì…ë ¥í•˜ê³  ë‚˜ë¨¸ì§€ëŠ” ì‹œìŠ¤í…œì´ ì²˜ë¦¬

### 2. ê´€ë¦¬ í¸ì˜ì„±
- `isSynced` í”Œë˜ê·¸ë¡œ ìˆ˜ë™/ìë™ ë²ˆì—­ êµ¬ë¶„
- ìë™ ë²ˆì—­ì€ í•„ìš”ì‹œ ê°œë³„ ìˆ˜ì • ê°€ëŠ¥

### 3. ë°ì´í„° ì¼ê´€ì„±
- ëª¨ë“  ì½˜í…ì¸ ê°€ ëª¨ë“  í™œì„± ì–¸ì–´ì— ëŒ€í•œ ë²ˆì—­ì„ ê°€ì§
- íŠ¹ì • ì–¸ì–´ì—ì„œ ì½˜í…ì¸ ê°€ ëˆ„ë½ë˜ëŠ” ì¼ ì—†ìŒ

### 4. í™•ì¥ì„±
- ìƒˆë¡œìš´ ì½˜í…ì¸  íƒ€ì… ì¶”ê°€ ì‹œ ë™ì¼í•œ íŒ¨í„´ ì¬ì‚¬ìš©
- ë²ˆì—­ ë™ê¸°í™” ë¡œì§ ì¤‘ì•™í™” ê°€ëŠ¥

## ğŸ”„ ìë™ ë™ê¸°í™” ì „ëµ (ì„ íƒì‚¬í•­)

### ì˜µì…˜ 1: ìˆ˜ë™ ë™ê¸°í™”

- ê¸°ë³¸ ì „ëµ
- `isSynced: true`ì¸ ë²ˆì—­ì€ ê·¸ëŒ€ë¡œ ìœ ì§€
- ê´€ë¦¬ìê°€ í•„ìš”ì‹œ ê°œë³„ ìˆ˜ì •

### ì˜µì…˜ 2: ìë™ ë™ê¸°í™”

- ê¸°ì¤€ ë²ˆì—­ ìˆ˜ì • ì‹œ `isSynced: true`ì¸ ëª¨ë“  ë²ˆì—­ ìë™ ì—…ë°ì´íŠ¸
- ì‹¤ì‹œê°„ ë™ê¸°í™” vs ë°±ê·¸ë¼ìš´ë“œ ë™ê¸°í™” ì„ íƒ ê°€ëŠ¥

```typescript
// ìë™ ë™ê¸°í™” ì˜ˆì‹œ
async ê¸°ì¤€_ë²ˆì—­_ìˆ˜ì •ì‹œ_ë™ê¸°í™”(contentId: string, baseLanguageId: string) {
  // ê¸°ì¤€ ë²ˆì—­ ì¡°íšŒ
  const baseTranslation = await this.getBaseTranslation(contentId, baseLanguageId);
  
  // isSynced: trueì¸ ë²ˆì—­ë“¤ ì—…ë°ì´íŠ¸
  await this.translationRepository.update(
    {
      [contentType + 'Id']: contentId,
      isSynced: true,
    },
    {
      title: baseTranslation.title,
      description: baseTranslation.description,
      updatedAt: new Date(),
    }
  );
}
```

## ğŸ“š ì ìš© ëŒ€ìƒ

ì´ ì „ëµì€ ë‹¤ìŒ ì—”í‹°í‹°ì— ì ìš©ë©ë‹ˆë‹¤:

- âœ… **Brochure** (ë¸Œë¡œìŠˆì–´) - ì´ë¯¸ êµ¬í˜„ë¨
- âœ… **ElectronicDisclosure** (ì „ìê³µì‹œ) - êµ¬í˜„ í•„ìš”
- ğŸ”„ **Announcement** (ê³µì§€ì‚¬í•­) - í–¥í›„ ì ìš©
- ğŸ”„ **News** (ë‰´ìŠ¤) - í–¥í›„ ì ìš©
- ğŸ”„ **IR** (IR ìë£Œ) - í–¥í›„ ì ìš©
- ğŸ”„ **ShareholdersMeeting** (ì£¼ì£¼ì´íšŒ) - í–¥í›„ ì ìš©
- ğŸ”„ **LumirStory** (ë£¨ë¯¸ë¥´ ìŠ¤í† ë¦¬) - í–¥í›„ ì ìš©

## ğŸ“ ì°¸ê³  ì‚¬í•­

1. **ì„±ëŠ¥ ê³ ë ¤ì‚¬í•­**
   - ë²ˆì—­ ë ˆì½”ë“œê°€ ë§ì•„ì§ˆ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì¸ë±ìŠ¤ ìµœì í™” í•„ìš”
   - `(contentId, languageId)` ë³µí•© UNIQUE ì¸ë±ìŠ¤ ê¶Œì¥

2. **íŠ¸ëœì­ì…˜ ê´€ë¦¬**
   - ë©”ì¸ ì½˜í…ì¸  ìƒì„±ê³¼ ë²ˆì—­ ìƒì„±ì€ í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ìœ¼ë¡œ ì²˜ë¦¬
   - ì‹¤íŒ¨ ì‹œ ë¡¤ë°± ë³´ì¥

3. **ë²„ì „ ê´€ë¦¬**
   - `version` í•„ë“œë¥¼ í™œìš©í•œ Optimistic Locking
   - ë™ì‹œ ìˆ˜ì • ì¶©ëŒ ë°©ì§€

4. **ì‚­ì œ ì •ì±…**
   - ë©”ì¸ ì½˜í…ì¸  ì‚­ì œ ì‹œ ë²ˆì—­ë„ CASCADE ì‚­ì œ
   - Soft Delete ì‚¬ìš© ê¶Œì¥
